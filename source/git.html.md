---
layout: flat
title: バージョン管理ツールを使おう
lead:  
pageid: git
---

## 論文を書く時のあるある

論文、特に共著論文を書いているとき、よく次のような問題が起こることがあります。

- 以前のバージョンをとっておいたら、間違えて以前のバージョンの方を書き換えてしまった。気づいた時には、何を書き換えたのかも分からない。
- 関連して、以前に直したつもりの間違いが、いつの間にか元に戻っている。
- ドラフトを書き換えたいのだけれど、今は他の人が書いているので、ややこしくないように自分の番が回ってくるのを待っている。
- 自分の番が終わって他の人に渡すとき、どこを変えたか伝えるのがめんどくさい。しかし、伝えないとどこが変わったか分からない。
- 複数人で同時に書き換えてしまった。しかもどこを変えたか忘れた。

これらの問題を人間の頭で管理しようとすると、とてもめんどくさいです。そんなときに役立つのが、バージョン管理ツールです。今のところ主に使っているのはプログラマーの人たちですが、きっとそのうち、研究者も当たり前のように使うようになると思います。

## バージョン管理ツールについて

代表的なバージョン管理ツールに[Git](http://git-scm.com/)と[Mercurial](http://mercurial.selenic.com/)があります。それぞれ一長一短あります。
詳しくは、[Mercurial 対 Git：なぜ Mercurial を選ぶのか？ ](http://japan.blogs.atlassian.com/2012/03/mercurial-vs-git-why-mercurial/)
と[Git 対 Mercurial：なぜ Git を選ぶのか？ ](http://japan.blogs.atlassian.com/2012/05/git-vs-mercurial-why-git/)を参照してみてください。
 ~~私は今のところ両方使ってます~~ 
私は今はgitを使っています。

どちらを使うにしても、バージョン管理ツールを使うと次のようなことができます。

- ひとまず切りのいい時点のファイルたちの状態を保存しておく（「コミット」といいます）ことができます。コミットはいくらでもできるし、それらを見やすい形で表示することが出来ます。
- 任意の２つの時点の差分を簡単に見ることができるので、「なにを書き換えたか」を忘れても大丈夫です。
- 過去のバージョンを手動でとっておく必要がないので、過去のバージョンの方を書き換えてしまうという悲劇は起こりません。
- 複数人での共同作業の際、みんなが同時に変更を加えることができます。
  - 後でそれらの変更を合わせる（「マージ」と呼ばれます）必要があります。それぞれの変更箇所が全然関係ない場所であれば自動でマージできます。
  - 自動でできない場合でも、それぞれの変更を見比べながらマージすることができます。ほとんどの場合、合わせ方は自明ですが、問題になりそうなら変えた人と相談しましょう。
  - いずれにしても、全て履歴、記録が残せるので安心です。

## 使ってみる

これらのバージョン管理ソフトは個人で使っても有用です。ぜひ、使ってみてください。

### インストール

#### GUI

たぶん多くの方にとって、GUI版の方が使いやすいと思います。
[SourceTree](https://www.sourcetreeapp.com/)が評判がよいようです。WindowsもMacもあります。GitもMercurialも使えます。ある程度長く使うには、登録が必要なようです。

#### コマンドライン

GUI版は慣れれば使いやすいのですが、CUIの方が取っ付き易いという方も多いと思います。そんな方にはCUI版があります。
Macなら、homebrew を使ってインストールするのが良いと思います。
Windows の場合は、[Git](http://git-scm.com/)か[Mercurial](http://mercurial.selenic.com/)に行くとバイナリーがおいてあります。

### チュートリアル

ネットにいろいろありますが例えば、CUIのものですが、[git入門 (全22回)ドットインストール](http://dotinstall.com/lessons/basic_git)は動画で丁寧に解説がされています。動画ではローカル開発環境というのを作ってやっていますが、コマンドラインのgitが動くならそれでOKです。

ほかにも様々なリモートリポジトリのホスティングサービスが説明やチュートリアルを用意しています。

### リモートリポジトリ

共同作業をするには、リモートリポジトリを作る必要があります。Dropboxやsshでloginできる普通のサーバーでもできないことはないのですが、専用のサーバーの方が便利です。自分でサーバーを立ててもよいのですが、普通の人にとっては面倒なので、以下の様なホスティングサービスを利用するのが便利です。

* [GitHub](https://github.com/)。Gitのみ。無料でも非公開プロジェクトが作れるようになった。
* [BitBucket](https://bitbucket.org/)。GitとMercurialが使える。無料では、非公開プロジェクトにコミットできるのは5人まで。

Gitなら、もうGitHubの方がいいと思います。Mercurialを使うならBitBucketしかないです。

## 共同作業

プロジェクトを立ち上げると、どこかにリモートリポジトリを作り、メンバーみんながpushできるようにする。それぞれのメンバーは、まずcloneして自分のマシンにローカルリポジトリを作る。朝来て作業を始めるときにはpullし、他の人にどんな進展があったかをチェック。ローカルリポジトリへのcommitは頻繁にやる。自分の作業がキリの良い所まで来たらpushする。他の人がすでにpushしていて自分がpush出来ない時には、ひとまずpullしてからpush。みたいな感じで進んでいくのだと思います。

## そうは言っても

こんな感じで作業をするためには共同研究者全員がツールの使い方にある程度慣れていなければならず、現状はすぐには難しいかもしれません。

ひとまずは、１人の作業で使ってみて、多くの人が慣れてくれば、こういうバージョン管理ツールを使った共同研究も容易になってくると思います。
